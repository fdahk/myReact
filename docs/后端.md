9.9:
    1.node çš„æ¨¡å—ç³»ç»Ÿ é€šè¿‡å¼•å…¥æ–¹å¼ å’Œ è·¯å¾„ æ¥åŒºåˆ† åº”ç”¨å†…çš„jsæ–‡ä»¶ è¿˜æ˜¯ å¤–éƒ¨jsæ–‡ä»¶ï¼Œä¸€ä¸ªjsæ–‡ä»¶ç›¸å½“äºä¸€ä¸ªæ¨¡å—

    2.ä¸ºä»€ä¹ˆèƒ½åœ¨ server è·¯å¾„ä¸‹ç›´æ¥è¿è¡Œ app.js
        package.json ä¸­çš„ type å­—æ®µ "type": "module"
        å‘Šè¯‰ Node.js å°†è¯¥é¡¹ç›®è§†ä¸º ES Module é¡¹ç›®ï¼Œæ”¯æŒ import/export è¯­æ³•
        
    3.æ§åˆ¶å™¨ï¼šWebåº”ç”¨ç¨‹åºä¸­çš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒæ˜¯MVCæ¶æ„æ¨¡å¼ä¸­çš„"C"éƒ¨åˆ†
        æ§åˆ¶å™¨æ˜¯å¤„ç†HTTPè¯·æ±‚çš„å…¥å£ç‚¹ï¼Œè´Ÿè´£ï¼š
            æ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„HTTPè¯·æ±‚
            è°ƒç”¨ç›¸åº”çš„ä¸šåŠ¡é€»è¾‘å¤„ç†
            è¿”å›å“åº”ç»™å®¢æˆ·ç«¯
    
    4.æ§åˆ¶å™¨ vs ä¸­é—´ä»¶ï¼š
        å¤„ç†æµç¨‹ï¼š
        HTTPè¯·æ±‚ â†’ å…¨å±€ä¸­é—´ä»¶ â†’ è·¯ç”±ä¸­é—´ä»¶ â†’ æ§åˆ¶å™¨ â†’ å“åº”
        1. HTTPè¯·æ±‚è¿›å…¥
        2. å…¨å±€ä¸­é—´ä»¶æ‰§è¡Œ (cors, æ—¥å¿—, è§£æç­‰)
        3. è·¯ç”±çº§ä¸­é—´ä»¶æ‰§è¡Œ (è®¤è¯, æƒé™ç­‰)
        4. ç®¡é“æ‰§è¡Œ (æ•°æ®éªŒè¯, è½¬æ¢)
        5. å®ˆå«æ‰§è¡Œ (æƒé™æ£€æŸ¥)
        6. æ‹¦æˆªå™¨æ‰§è¡Œ (å‰ç½®å¤„ç†)
        7. æ§åˆ¶å™¨æ–¹æ³•æ‰§è¡Œ â† ä½ çš„ä¸šåŠ¡é€»è¾‘åœ¨è¿™é‡Œ
        8. æ‹¦æˆªå™¨æ‰§è¡Œ (åç½®å¤„ç†)
        9. è¿‡æ»¤å™¨æ‰§è¡Œ (å¼‚å¸¸å¤„ç†)
        10. å“åº”è¿”å›å®¢æˆ·ç«¯

        èŒè´£ï¼š
        ç‰¹æ€§	    ä¸­é—´ä»¶	                        æ§åˆ¶å™¨
        ä¸»è¦èŒè´£	é¢„å¤„ç†ã€éªŒè¯ã€æ—¥å¿—	            ä¸šåŠ¡é€»è¾‘å¤„ç†
        æ˜¯å¦ç»ˆç»“è¯·æ±‚	é€šå¸¸ä¸ç»ˆç»“ï¼Œè°ƒç”¨next()	    ç»ˆç»“è¯·æ±‚ï¼Œè¿”å›å“åº”
        ä½œç”¨èŒƒå›´	æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼Œå¤šä¸ªè·¯ç”±	        ç‰¹å®šè·¯ç”±çš„ä¸šåŠ¡å¤„ç†
        æ‰§è¡Œé¡ºåº	è¯·æ±‚å¤„ç†é“¾çš„å‰ç«¯	            è¯·æ±‚å¤„ç†é“¾çš„æœ«ç«¯

        ä¸­é—´ä»¶ï¼šåƒæ˜¯"é—¨å«"ï¼Œè´Ÿè´£æ£€æŸ¥ã€è®°å½•ã€é¢„å¤„ç†ï¼Œç„¶åæ”¾è¡Œ
        æ§åˆ¶å™¨ï¼šåƒæ˜¯"åŠäº‹å‘˜"ï¼Œè´Ÿè´£å…·ä½“å¤„ç†ä½ çš„ä¸šåŠ¡éœ€æ±‚

9.22ï¼š
    1.NestJS CLI æœ‰å¼ºå¤§çš„ä»£ç ç”Ÿæˆå™¨ï¼Œå’Œä¸°å¯Œçš„ä»£ç ç”Ÿæˆå‘½ä»¤

    2.nest æ˜¯åŸºäº expressçš„

    3.

9.27:
    1.linuxæœåŠ¡å™¨

# nuxtå’Œnext
    ## ä¸»è¦ç‰¹ç‚¹æ˜¯ SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰+ å…¨æ ˆå¼€å‘èƒ½åŠ›
        å¹¶ä¸ä»…ä»…æ˜¯"åœ¨å‰ç«¯å†™åç«¯"ï¼Œæ›´å‡†ç¡®çš„ç†è§£æ˜¯ï¼š
        Nuxt.jsï¼ˆåŸºäº Vueï¼‰å’Œ Next.jsï¼ˆåŸºäº Reactï¼‰çš„æ ¸å¿ƒä¼˜åŠ¿æ˜¯ï¼š
        âœ… SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰ï¼šåœ¨æœåŠ¡å™¨ç«¯é¢„æ¸²æŸ“é¡µé¢ï¼Œæé«˜é¦–å±é€Ÿåº¦å’ŒSEO
        âœ… SSGï¼ˆé™æ€ç«™ç‚¹ç”Ÿæˆï¼‰ï¼šæ„å»ºæ—¶ç”Ÿæˆé™æ€HTML
        âœ… API Routesï¼ˆAPIè·¯ç”±ï¼‰ï¼šå¯ä»¥åœ¨åŒä¸€é¡¹ç›®ä¸­ç¼–å†™æœåŠ¡ç«¯APIæ¥å£
        âœ… æ–‡ä»¶ç³»ç»Ÿè·¯ç”±ï¼šåŸºäºæ–‡ä»¶ç»“æ„è‡ªåŠ¨ç”Ÿæˆè·¯ç”±
        âœ… è‡ªåŠ¨ä»£ç åˆ†å‰²ï¼šä¼˜åŒ–åŠ è½½æ€§èƒ½
    ## å…³äº"å†™åç«¯"çš„å‡†ç¡®ç†è§£
        èƒ½åšï¼š
        - ç¼–å†™ API æ¥å£ï¼ˆAPI Routesï¼‰
        - å¤„ç†è¡¨å•æäº¤
        - æ•°æ®åº“æŸ¥è¯¢ï¼ˆè½»é‡çº§ï¼‰
        - ç¬¬ä¸‰æ–¹APIè°ƒç”¨
        - BFFï¼ˆBackend For Frontendï¼‰å±‚

        ä¸èƒ½æ›¿ä»£ï¼š
        - å®Œæ•´çš„åç«¯æ¡†æ¶ï¼ˆå¦‚ NestJSã€Expressï¼‰
        - å¤æ‚çš„ä¸šåŠ¡é€»è¾‘æœåŠ¡
        - å¾®æœåŠ¡æ¶æ„
        - ç‹¬ç«‹çš„åç«¯æœåŠ¡

1. æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰èƒ½åŠ›
    ä¼ ç»ŸCSRï¼ˆå®¢æˆ·ç«¯æ¸²æŸ“ï¼‰çš„é—®é¢˜
        // React + Viteï¼ˆä½ å½“å‰çš„æ–¹æ¡ˆï¼‰
        // 1. æµè§ˆå™¨ä¸‹è½½HTMLï¼ˆå‡ ä¹æ˜¯ç©ºçš„ï¼‰
        // 2. ä¸‹è½½JavaScript Bundle
        // 3. æ‰§è¡ŒJSï¼Œæ¸²æŸ“é¡µé¢
        // 4. é¡µé¢å¯è§ âŒ æ…¢ï¼ŒSEOå·®

    // Next.js
        // 1. æœåŠ¡å™¨ç›´æ¥è¿”å›æ¸²æŸ“å¥½çš„HTML
        // 2. æµè§ˆå™¨ç›´æ¥æ˜¾ç¤ºå†…å®¹ âœ… å¿«ï¼ŒSEOå¥½
        // 3. ä¸‹è½½JSï¼Œæ¿€æ´»äº¤äº’ï¼ˆHydrationï¼‰
        // Next.js
        // 1. æœåŠ¡å™¨ç›´æ¥è¿”å›æ¸²æŸ“å¥½çš„HTML
        // 2. æµè§ˆå™¨ç›´æ¥æ˜¾ç¤ºå†…å®¹ âœ… å¿«ï¼ŒSEOå¥½
        // 3. ä¸‹è½½JSï¼Œæ¿€æ´»äº¤äº’ï¼ˆHydrationï¼‰

    é™æ€ç«™ç‚¹ç”Ÿæˆï¼ˆSSGï¼‰
        // Next.js - æ„å»ºæ—¶é¢„æ¸²æŸ“
        export async function getStaticProps() {
        const data = await fetchData()
        return { props: { data } }
        }
        // æ„å»ºæ—¶ç”ŸæˆHTMLæ–‡ä»¶
        // éƒ¨ç½²åæ— éœ€æœåŠ¡å™¨ï¼Œç›´æ¥ç”¨CDN
        âœ… æ€§èƒ½æè‡´ - çº¯é™æ€æ–‡ä»¶ï¼ŒCDNåˆ†å‘
        âœ… æˆæœ¬ä½ - æ— éœ€åç«¯æœåŠ¡å™¨
        âœ… é€‚åˆåšå®¢ã€æ–‡æ¡£ã€è¥é”€é¡µ

    Next.js è‡ªåŠ¨è·¯ç”±
        pages/
        index.js          â†’ /
        about.js          â†’ /about
        posts/[id].js     â†’ /posts/:id
        # æ— éœ€é…ç½®ï¼Œè‡ªåŠ¨ç”Ÿæˆè·¯ç”±
        âœ… é›¶é…ç½® - åˆ›å»ºæ–‡ä»¶å³åˆ›å»ºè·¯ç”±
        âœ… ç›´è§‚ - æ–‡ä»¶ç»“æ„å³è·¯ç”±ç»“æ„
        âœ… é«˜æ•ˆ - å‡å°‘æ ·æ¿ä»£ç 

    APIè·¯ç”±ï¼ˆBackend for Frontendï¼‰
        // Next.js - pages/api/hello.js
        export default function handler(req, res) {
        res.status(200).json({ message: 'Hello' })
        }
        // è®¿é—®ï¼š/api/hello
        // æ— éœ€å•ç‹¬çš„åç«¯æœåŠ¡å™¨
        âœ… å…¨æ ˆå¼€å‘ - å‰åç«¯ä¸€ä½“
        âœ… ç®€åŒ–æ¶æ„ - å°é¡¹ç›®æ— éœ€NestJSè¿™æ ·çš„åç«¯
        âœ… é€‚åˆBFFæ¨¡å¼ - èšåˆå¤šä¸ªåç«¯API

    å›¾åƒä¼˜åŒ–
        // Next.js Imageç»„ä»¶
        import Image from 'next/image'

        <Image 
        src="/photo.jpg" 
        width={500} 
        height={300}
        // è‡ªåŠ¨ä¼˜åŒ–ï¼šæ ¼å¼è½¬æ¢ã€æ‡’åŠ è½½ã€å“åº”å¼
        />
        è‡ªåŠ¨ä¼˜åŒ–ï¼š
        WebP/AVIFæ ¼å¼è½¬æ¢
        å“åº”å¼å›¾ç‰‡
        æ‡’åŠ è½½
        å ä½ç¬¦

âœ… é€‚åˆç”¨ Next.js/Nuxt çš„åœºæ™¯
åœºæ™¯	åŸå› 
ç”µå•†ç½‘ç«™	SEOé‡è¦ã€é¦–å±é€Ÿåº¦è¦æ±‚é«˜
ä¼ä¸šå®˜ç½‘	SEOã€ç¤¾äº¤åˆ†äº«ã€è¥é”€éœ€æ±‚
åšå®¢/æ–°é—»	å†…å®¹é©±åŠ¨ã€SEOæ ¸å¿ƒ
SaaSäº§å“è¥é”€é¡µ	éœ€è¦å¿«é€ŸåŠ è½½å’ŒSEO
å†…å®¹ç®¡ç†ç³»ç»Ÿ	åŠ¨æ€å†…å®¹ + SEO
âŒ ä¸é€‚åˆç”¨çš„åœºæ™¯
åœºæ™¯	åŸå› 	æ¨èæ–¹æ¡ˆ
å†…éƒ¨ç®¡ç†ç³»ç»Ÿ	æ— éœ€SEOã€ç™»å½•åä½¿ç”¨	React + Viteï¼ˆä½ å½“å‰æ–¹æ¡ˆï¼‰âœ…
æ•°æ®å¯è§†åŒ–åå°	çº¯å®¢æˆ·ç«¯äº¤äº’	React + Vite
WebGLæ¸¸æˆ	çº¯å®¢æˆ·ç«¯æ¸²æŸ“	åŸç”Ÿæ¡†æ¶
Electronæ¡Œé¢åº”ç”¨	æ— éœ€SSR	React/Vue

# Next.js å’Œ Nuxt.js æ·±åº¦åŸç†

### âœ… æ­£ç¡®ç†è§£
**Next.js æ˜¯ React çš„ã€Œå…ƒæ¡†æ¶ã€ï¼ˆMeta-Frameworkï¼‰**
- åœ¨ReactåŸºç¡€ä¸Šæä¾›**å®Œæ•´çš„åº”ç”¨æ¶æ„**
- ä¸ä»…ä»…æ˜¯å°è£…ï¼Œè€Œæ˜¯æä¾›**è¿è¡Œæ—¶ç¯å¢ƒ + æ„å»ºç³»ç»Ÿ + è·¯ç”±ç³»ç»Ÿ + æœåŠ¡ç«¯èƒ½åŠ›**

```
React          â†’ è§†å›¾å±‚åº“ï¼ˆåªè´Ÿè´£UIæ¸²æŸ“ï¼‰
Next.js        â†’ å®Œæ•´æ¡†æ¶ï¼ˆReact + è·¯ç”± + SSR + æ„å»º + éƒ¨ç½²ï¼‰

ç±»æ¯”ï¼š
React          â†’ æ±½è½¦å¼•æ“
Next.js        â†’ å®Œæ•´çš„æ±½è½¦ï¼ˆå¼•æ“ + è½¦èº« + å¯¼èˆª + è‡ªåŠ¨é©¾é©¶ï¼‰
```

---

## äºŒã€æ ¸å¿ƒåŸç†æ¶æ„

### 1. Next.js çš„åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å¼€å‘è€…ç¼–å†™çš„ React ç»„ä»¶            â”‚  â† ä½ å†™çš„ä»£ç 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Next.js æ¡†æ¶å±‚ï¼ˆæ ¸å¿ƒåŸç†åœ¨è¿™é‡Œï¼‰      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ–‡ä»¶ç³»ç»Ÿè·¯ç”±ï¼ˆFile Routerï¼‰       â”‚   â”‚
â”‚  â”‚  pages/ â†’ è‡ªåŠ¨ç”Ÿæˆè·¯ç”±é…ç½®         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ¸²æŸ“æ¨¡å¼è°ƒåº¦å™¨ï¼ˆRendererï¼‰        â”‚   â”‚
â”‚  â”‚  - SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰              â”‚   â”‚
â”‚  â”‚  - SSGï¼ˆé™æ€ç”Ÿæˆï¼‰                â”‚   â”‚
â”‚  â”‚  - ISRï¼ˆå¢é‡é™æ€å†ç”Ÿï¼‰            â”‚   â”‚
â”‚  â”‚  - CSRï¼ˆå®¢æˆ·ç«¯æ¸²æŸ“ï¼‰              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ•°æ®è·å–å±‚ï¼ˆData Fetchingï¼‰       â”‚   â”‚
â”‚  â”‚  - getServerSideProps()          â”‚   â”‚
â”‚  â”‚  - getStaticProps()              â”‚   â”‚
â”‚  â”‚  - getInitialProps()             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ„å»ºä¼˜åŒ–å™¨ï¼ˆBuild Optimizerï¼‰     â”‚   â”‚
â”‚  â”‚  - ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰     â”‚   â”‚
â”‚  â”‚  - Tree Shaking                  â”‚   â”‚
â”‚  â”‚  - å›¾ç‰‡ä¼˜åŒ–                       â”‚   â”‚
â”‚  â”‚  - å­—ä½“ä¼˜åŒ–                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         React æ ¸å¿ƒï¼ˆæ¸²æŸ“å¼•æ“ï¼‰            â”‚  â† Reactåº“
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Node.js è¿è¡Œæ—¶ï¼ˆSSRç¯å¢ƒï¼‰            â”‚  â† æœåŠ¡ç«¯ç¯å¢ƒ
â”‚      æˆ– æµè§ˆå™¨ç¯å¢ƒï¼ˆCSRç¯å¢ƒï¼‰              â”‚     å®¢æˆ·ç«¯ç¯å¢ƒ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€æ ¸å¿ƒåŸç†è¯¦è§£

### åŸç†1: æ–‡ä»¶ç³»ç»Ÿè·¯ç”±ï¼ˆFile-based Routingï¼‰

#### å®ç°åŸç†
```javascript
// Next.js åœ¨å¯åŠ¨æ—¶åšçš„äº‹æƒ…ï¼š

// 1. æ‰«æ pages ç›®å½•
const pagesDir = './pages'
const files = scanDirectory(pagesDir)
// å‘ç°: ['index.js', 'about.js', 'posts/[id].js']

// 2. è‡ªåŠ¨ç”Ÿæˆè·¯ç”±æ˜ å°„è¡¨
const routes = {
  '/': () => import('./pages/index.js'),
  '/about': () => import('./pages/about.js'),
  '/posts/:id': () => import('./pages/posts/[id].js')
}

// 3. åˆ›å»ºæœåŠ¡å™¨è·¯ç”±æˆ–å®¢æˆ·ç«¯è·¯ç”±
// æœåŠ¡ç«¯ï¼ˆSSRï¼‰
app.get('/', async (req, res) => {
  const Page = await import('./pages/index.js')
  const html = renderToString(<Page />)
  res.send(html)
})

// å®¢æˆ·ç«¯ï¼ˆCSRï¼‰
window.addEventListener('popstate', () => {
  const Page = routes[location.pathname]
  render(<Page />, document.getElementById('root'))
})
```

#### åŠ¨æ€è·¯ç”±å®ç°
```javascript
// pages/posts/[id].js
export default function Post({ params }) {
  return <div>Post ID: {params.id}</div>
}

// Next.js å†…éƒ¨å¤„ç†
const routePattern = '/posts/[id]'
const regex = /^\/posts\/([^/]+)$/  // è½¬æ¢ä¸ºæ­£åˆ™

// è¯·æ±‚ /posts/123 æ—¶
const match = '/posts/123'.match(regex)
const params = { id: match[1] }  // { id: '123' }
```

---

### åŸç†2: æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰æ ¸å¿ƒæµç¨‹

#### å®Œæ•´çš„ SSR è¯·æ±‚å¤„ç†æµç¨‹

```javascript
// ç”¨æˆ·è®¿é—® /products/123

// ========== æœåŠ¡ç«¯ï¼ˆNode.jsï¼‰==========
// æ­¥éª¤1: æ¥æ”¶HTTPè¯·æ±‚
app.get('/products/:id', async (req, res) => {
  
  // æ­¥éª¤2: åŠ è½½é¡µé¢ç»„ä»¶
  const PageComponent = await import('./pages/products/[id].js')
  
  // æ­¥éª¤3: æ‰§è¡Œæ•°æ®è·å–å‡½æ•°ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šï¼‰
  const context = { params: { id: req.params.id } }
  const props = await PageComponent.getServerSideProps(context)
  // props = { product: { name: 'iPhone', price: 999 } }
  
  // æ­¥éª¤4: åœ¨æœåŠ¡å™¨ä¸Šæ¸²æŸ“ React ç»„ä»¶
  import { renderToString } from 'react-dom/server'
  const htmlContent = renderToString(
    <PageComponent {...props} />
  )
  // htmlContent = '<div><h1>iPhone</h1><p>$999</p></div>'
  
  // æ­¥éª¤5: ç”Ÿæˆå®Œæ•´çš„HTMLæ–‡æ¡£
  const fullHTML = `
    <!DOCTYPE html>
    <html>
      <head>
        <title>äº§å“é¡µ</title>
        <script>
          window.__NEXT_DATA__ = ${JSON.stringify(props)}
        </script>
      </head>
      <body>
        <div id="__next">${htmlContent}</div>
        <script src="/_next/static/chunks/main.js"></script>
      </body>
    </html>
  `
  
  // æ­¥éª¤6: è¿”å›å®Œæ•´HTMLç»™æµè§ˆå™¨
  res.send(fullHTML)
})

// ========== å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰==========
// æ­¥éª¤7: æµè§ˆå™¨æ¥æ”¶HTMLï¼Œç«‹å³æ˜¾ç¤ºå†…å®¹ï¼ˆé¦–å±å¿«ï¼‰
// ç”¨æˆ·å¯ä»¥çœ‹åˆ°å†…å®¹ï¼Œä½†è¿˜ä¸èƒ½äº¤äº’

// æ­¥éª¤8: ä¸‹è½½å¹¶æ‰§è¡Œ JavaScript
// main.js ä¸‹è½½å®Œæˆ

// æ­¥éª¤9: Hydrationï¼ˆæ°´åˆ/æ¿€æ´»ï¼‰
import { hydrateRoot } from 'react-dom/client'

const props = window.__NEXT_DATA__  // è·å–æœåŠ¡ç«¯ä¼ é€’çš„æ•°æ®
const PageComponent = import('./pages/products/[id].js')

hydrateRoot(
  document.getElementById('__next'),
  <PageComponent {...props} />
)
// React æ¥ç®¡å·²æœ‰çš„HTMLï¼Œç»‘å®šäº‹ä»¶ç›‘å¬å™¨

// æ­¥éª¤10: é¡µé¢å®Œå…¨å¯äº¤äº’
```

#### å…³é”®æŠ€æœ¯ï¼šHydrationï¼ˆæ°´åˆï¼‰

```javascript
// æœåŠ¡ç«¯æ¸²æŸ“çš„HTMLï¼ˆé™æ€ï¼‰
<button>ç‚¹å‡»æˆ‘</button>

// æµè§ˆå™¨æ”¶åˆ°åï¼Œç”¨æˆ·èƒ½çœ‹åˆ°æŒ‰é’®ï¼Œä½†ç‚¹å‡»æ— æ•ˆ

// Hydration è¿‡ç¨‹ï¼ˆReactæ¥ç®¡ï¼‰
const button = document.querySelector('button')
button.addEventListener('click', handleClick)  // ç»‘å®šäº‹ä»¶

// ç°åœ¨æŒ‰é’®å¯ä»¥ç‚¹å‡»äº†
```

**Hydration åŸç†**ï¼š
```
æœåŠ¡ç«¯æ¸²æŸ“çš„HTMLï¼ˆæ— äº¤äº’ï¼‰
         â†“
    ä¸‹è½½JavaScript
         â†“
    Reactæ‰§è¡Œ hydrateRoot()
         â†“
    å¯¹æ¯”è™šæ‹ŸDOMå’ŒçœŸå®DOM
         â†“
    å¤ç”¨ç°æœ‰HTMLç»“æ„
         â†“
    ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
         â†“
    é¡µé¢å¯äº¤äº’
```

---

### åŸç†3: é™æ€ç«™ç‚¹ç”Ÿæˆï¼ˆSSGï¼‰

#### æ„å»ºæ—¶é¢„æ¸²æŸ“

```javascript
// pages/blog/[slug].js
export default function BlogPost({ post }) {
  return <article>{post.content}</article>
}

// åœ¨æ„å»ºæ—¶æ‰§è¡Œï¼ˆnpm run buildï¼‰
export async function getStaticPaths() {
  // å‘Šè¯‰Next.jséœ€è¦ç”Ÿæˆå“ªäº›é¡µé¢
  const posts = await fetchAllPosts()
  return {
    paths: [
      { params: { slug: 'hello-world' } },
      { params: { slug: 'next-tutorial' } }
    ]
  }
}

export async function getStaticProps({ params }) {
  // è·å–æ¯ä¸ªé¡µé¢çš„æ•°æ®
  const post = await fetchPost(params.slug)
  return { props: { post } }
}

// ========== æ„å»ºè¿‡ç¨‹ ==========
// Next.js åœ¨ build æ—¶åšçš„äº‹ï¼š

// 1. è°ƒç”¨ getStaticPathsï¼Œè·å–æ‰€æœ‰è·¯å¾„
const paths = await getStaticPaths()
// ['/blog/hello-world', '/blog/next-tutorial']

// 2. å¯¹æ¯ä¸ªè·¯å¾„è°ƒç”¨ getStaticProps
for (const path of paths) {
  const props = await getStaticProps({ params: path.params })
  
  // 3. æ¸²æŸ“ç»„ä»¶
  const html = renderToString(<BlogPost {...props} />)
  
  // 4. å†™å…¥é™æ€HTMLæ–‡ä»¶
  fs.writeFileSync(
    `.next/server/pages/blog/${path.params.slug}.html`,
    html
  )
}

// ========== ç”Ÿæˆçš„æ–‡ä»¶ç»“æ„ ==========
// .next/server/pages/blog/
//   â”œâ”€â”€ hello-world.html      â† é¢„æ¸²æŸ“çš„é™æ€æ–‡ä»¶
//   â””â”€â”€ next-tutorial.html    â† é¢„æ¸²æŸ“çš„é™æ€æ–‡ä»¶

// ========== è¿è¡Œæ—¶ï¼ˆç”¨æˆ·è®¿é—®ï¼‰==========
// ç”¨æˆ·è®¿é—® /blog/hello-world
// æœåŠ¡å™¨ç›´æ¥è¿”å› hello-world.htmlï¼ˆç§’å¼€ï¼‰
```

---

### åŸç†4: å¢é‡é™æ€å†ç”Ÿï¼ˆISRï¼‰

```javascript
// pages/products/[id].js
export async function getStaticProps({ params }) {
  const product = await fetchProduct(params.id)
  return {
    props: { product },
    revalidate: 60  // â† å…³é”®ï¼š60ç§’åé‡æ–°ç”Ÿæˆ
  }
}

// ========== ISR å·¥ä½œæµç¨‹ ==========

// T=0: æ„å»ºæ—¶ç”Ÿæˆ product-1.html
// ç”¨æˆ·Aè®¿é—® /products/1 â†’ è¿”å›ç¼“å­˜çš„HTMLï¼ˆå¿«ï¼‰

// T=30: ç”¨æˆ·Bè®¿é—® /products/1 â†’ è¿”å›ç¼“å­˜çš„HTMLï¼ˆå¿«ï¼‰

// T=65: ç”¨æˆ·Cè®¿é—® /products/1
// 1. å…ˆè¿”å›æ—§çš„ç¼“å­˜HTMLç»™ç”¨æˆ·Cï¼ˆä¿è¯é€Ÿåº¦ï¼‰
// 2. åå°è§¦å‘é‡æ–°ç”Ÿæˆï¼š
//    - è°ƒç”¨ getStaticProps() è·å–æœ€æ–°æ•°æ®
//    - é‡æ–°æ¸²æŸ“é¡µé¢
//    - æ›´æ–°ç¼“å­˜
// 3. ä¸‹æ¬¡è®¿é—®æ—¶è¿”å›æ–°HTML

// T=70: ç”¨æˆ·Dè®¿é—® /products/1 â†’ è¿”å›æ–°HTML
```

**ISR vs SSG vs SSR å¯¹æ¯”**ï¼š
```
SSG: æ„å»ºæ—¶ç”Ÿæˆï¼Œæ°¸ä¸æ›´æ–°
  æ„å»º â†’ HTMLæ–‡ä»¶ â†’ æ°¸ä¹…ç¼“å­˜
  
ISR: æ„å»ºæ—¶ç”Ÿæˆï¼Œå®šæ—¶é‡æ–°ç”Ÿæˆ
  æ„å»º â†’ HTMLæ–‡ä»¶ â†’ 60ç§’åè¿‡æœŸ â†’ åå°é‡æ–°ç”Ÿæˆ â†’ æ›´æ–°ç¼“å­˜
  
SSR: æ¯æ¬¡è¯·æ±‚éƒ½ç”Ÿæˆ
  è¯·æ±‚ â†’ å®æ—¶æ¸²æŸ“ â†’ è¿”å›HTML â†’ ä¸ç¼“å­˜
```

---

### åŸç†5: è‡ªåŠ¨ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰

```javascript
// Next.js è‡ªåŠ¨åšçš„ä¼˜åŒ–

// pages/index.js
import Header from '../components/Header'  // 30KB
import Footer from '../components/Footer'  // 20KB

export default function Home() {
  return (
    <div>
      <Header />
      <main>é¦–é¡µå†…å®¹</main>
      <Footer />
    </div>
  )
}

// pages/about.js
import Header from '../components/Header'  // 30KB
import TeamList from '../components/TeamList'  // 50KB

export default function About() {
  return (
    <div>
      <Header />
      <TeamList />
    </div>
  )
}

// ========== Next.js è‡ªåŠ¨åˆ†å‰²ç­–ç•¥ ==========

// æ„å»ºåçš„æ–‡ä»¶ç»“æ„ï¼š
// _next/static/chunks/
//   â”œâ”€â”€ framework.js        (Reactæ ¸å¿ƒ, æ‰€æœ‰é¡µé¢å…±äº«)
//   â”œâ”€â”€ main.js             (Next.jsè¿è¡Œæ—¶, æ‰€æœ‰é¡µé¢å…±äº«)
//   â”œâ”€â”€ commons.js          (Headerç»„ä»¶, å¤šé¡µé¢å…±äº«)
//   â”œâ”€â”€ pages/
//   â”‚   â”œâ”€â”€ index.js        (é¦–é¡µç‹¬æœ‰: Footer)
//   â”‚   â””â”€â”€ about.js        (å…³äºé¡µç‹¬æœ‰: TeamList)

// ç”¨æˆ·è®¿é—®é¦–é¡µæ—¶åªåŠ è½½ï¼š
// framework.js + main.js + commons.js + pages/index.js
// æ€»è®¡: React + Next.js + Header + Footer

// ç”¨æˆ·ä»é¦–é¡µå¯¼èˆªåˆ°å…³äºé¡µæ—¶ï¼š
// åªéœ€é¢å¤–åŠ è½½: pages/about.js (TeamList)
// å·²åŠ è½½çš„ frameworkã€mainã€commons ç›´æ¥å¤ç”¨
```

#### åŠ¨æ€å¯¼å…¥ï¼ˆæ‰‹åŠ¨åˆ†å‰²ï¼‰

```javascript
// ä½¿ç”¨ dynamic import å»¶è¿ŸåŠ è½½é‡å‹ç»„ä»¶
import dynamic from 'next/dynamic'

// ä¸ä½¿ç”¨åŠ¨æ€å¯¼å…¥ï¼ˆåˆå§‹åŒ…ä¼šå¾ˆå¤§ï¼‰
import HeavyChart from '../components/HeavyChart'  // 2MB

// ä½¿ç”¨åŠ¨æ€å¯¼å…¥ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰
const HeavyChart = dynamic(() => import('../components/HeavyChart'), {
  loading: () => <p>åŠ è½½ä¸­...</p>,  // åŠ è½½æ—¶æ˜¾ç¤º
  ssr: false  // ç¦ç”¨SSRï¼Œåªåœ¨å®¢æˆ·ç«¯åŠ è½½
})

export default function Dashboard() {
  const [showChart, setShowChart] = useState(false)
  
  return (
    <div>
      <button onClick={() => setShowChart(true)}>
        æ˜¾ç¤ºå›¾è¡¨
      </button>
      {showChart && <HeavyChart />}  {/* ç‚¹å‡»æ—¶æ‰ä¸‹è½½2MB */}
    </div>
  )
}
```

---

## å››ã€Nuxt.js åŸç†ï¼ˆVueç”Ÿæ€çš„Next.jsï¼‰

### Nuxt.js æ¶æ„ï¼ˆä¸Next.jsé«˜åº¦ç›¸ä¼¼ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å¼€å‘è€…ç¼–å†™çš„ Vue ç»„ä»¶              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Nuxt.js æ¡†æ¶å±‚                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ–‡ä»¶ç³»ç»Ÿè·¯ç”±                     â”‚   â”‚
â”‚  â”‚  pages/ â†’ è‡ªåŠ¨ç”Ÿæˆè·¯ç”±            â”‚   â”‚  â† ä¸Next.jsç›¸åŒ
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ¸²æŸ“æ¨¡å¼                         â”‚   â”‚
â”‚  â”‚  - SSR                           â”‚   â”‚
â”‚  â”‚  - SSG                           â”‚   â”‚
â”‚  â”‚  - SPA                           â”‚   â”‚  â† ä¸Next.jsç›¸åŒ
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ•°æ®è·å–                         â”‚   â”‚
â”‚  â”‚  - asyncData()                   â”‚   â”‚
â”‚  â”‚  - fetch()                       â”‚   â”‚  â† APIä¸åŒï¼ŒåŸç†ç›¸åŒ
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Vue æ ¸å¿ƒï¼ˆæ¸²æŸ“å¼•æ“ï¼‰              â”‚  â† Vueåº“ï¼ˆæ›¿æ¢Reactï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Node.js æˆ– æµè§ˆå™¨ç¯å¢ƒ                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Nuxt.js SSR æµç¨‹ï¼ˆä¸Next.jså‡ ä¹ç›¸åŒï¼‰

```javascript
// pages/products/_id.vue
<template>
  <div>
    <h1>{{ product.name }}</h1>
    <p>{{ product.price }}</p>
  </div>
</template>

<script>
export default {
  // æœåŠ¡ç«¯æ•°æ®è·å–ï¼ˆç±»ä¼¼ Next.js çš„ getServerSidePropsï¼‰
  async asyncData({ params, $axios }) {
    const product = await $axios.$get(`/api/products/${params.id}`)
    return { product }
  }
}
</script>

// ========== Nuxt.js å†…éƒ¨å¤„ç†æµç¨‹ ==========

// 1. æœåŠ¡ç«¯æ¥æ”¶è¯·æ±‚ /products/123
app.get('/products/:id', async (req, res) => {
  
  // 2. åŠ è½½Vueç»„ä»¶
  const Component = await import('./pages/products/_id.vue')
  
  // 3. æ‰§è¡Œ asyncDataï¼ˆåœ¨æœåŠ¡å™¨ä¸Šï¼‰
  const data = await Component.asyncData({
    params: { id: req.params.id }
  })
  
  // 4. ä½¿ç”¨ Vue SSR æ¸²æŸ“
  import { renderToString } from 'vue/server-renderer'
  const html = await renderToString(
    createApp(Component, data)
  )
  
  // 5. ç”Ÿæˆå®Œæ•´HTMLï¼ˆåŒ…å«æ•°æ®ï¼‰
  const fullHTML = `
    <!DOCTYPE html>
    <html>
      <body>
        <div id="__nuxt">${html}</div>
        <script>
          window.__NUXT__ = ${JSON.stringify(data)}
        </script>
        <script src="/_nuxt/app.js"></script>
      </body>
    </html>
  `
  
  res.send(fullHTML)
})

// 6. å®¢æˆ·ç«¯ Hydrationï¼ˆä¸Next.jsç›¸åŒï¼‰
// Vue æ¥ç®¡HTMLï¼Œç»‘å®šäº‹ä»¶
```

---

## äº”ã€Next.js vs Nuxt.js æ ¸å¿ƒå¯¹æ¯”

| ç»´åº¦ | Next.js | Nuxt.js |
|------|---------|---------|
| **åŸºç¡€æ¡†æ¶** | React | Vue |
| **æ–‡ä»¶è·¯ç”±** | pages/ æˆ– app/ | pages/ |
| **åŠ¨æ€è·¯ç”±** | [id].js | _id.vue æˆ– [...slug].vue |
| **SSRå®ç°** | renderToString (React) | renderToString (Vue) |
| **æ•°æ®è·å–** | getServerSideProps() | asyncData() / fetch() |
| **é™æ€ç”Ÿæˆ** | getStaticProps() | generate æ¨¡å¼ |
| **APIè·¯ç”±** | pages/api/ | server/api/ |
| **å›¾ç‰‡ä¼˜åŒ–** | next/image | nuxt/image |
| **çŠ¶æ€ç®¡ç†** | React Context/Redux | Vuex/Pinia |
| **æ€§èƒ½ä¼˜åŒ–** | è‡ªåŠ¨ä»£ç åˆ†å‰² | è‡ªåŠ¨ä»£ç åˆ†å‰² |

**æ ¸å¿ƒç»“è®º**ï¼š
- **åŸç†å®Œå…¨ç›¸åŒ**ï¼Œåªæ˜¯åº•å±‚æ¸²æŸ“å¼•æ“ä¸åŒï¼ˆReact vs Vueï¼‰
- éƒ½æ˜¯**å…ƒæ¡†æ¶**ï¼Œæä¾›å®Œæ•´çš„åº”ç”¨è§£å†³æ–¹æ¡ˆ
- éƒ½è§£å†³ç›¸åŒçš„é—®é¢˜ï¼šSSRã€SEOã€æ€§èƒ½ä¼˜åŒ–

---

## å…­ã€å…³é”®æŠ€æœ¯åŸç†æ·±å…¥

### 1. æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ä»£ç åˆ†ç¦»

```javascript
// Next.js å¦‚ä½•åŒºåˆ†æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä»£ç 

// è¿™æ®µä»£ç åªåœ¨æœåŠ¡ç«¯è¿è¡Œ
export async function getServerSideProps() {
  const fs = require('fs')  // Node.js APIï¼Œæµè§ˆå™¨æ²¡æœ‰
  const data = fs.readFileSync('data.json')
  return { props: { data } }
}

// è¿™æ®µä»£ç åœ¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½è¿è¡Œ
export default function Page({ data }) {
  // æœåŠ¡ç«¯ï¼šrenderToStringæ—¶æ‰§è¡Œ
  // å®¢æˆ·ç«¯ï¼šhydrationæ—¶æ‰§è¡Œ
  return <div>{data}</div>
}

// ========== Next.js çš„æ„å»ºé­”æ³• ==========

// æ„å»ºæ—¶ç”Ÿæˆä¸¤ä¸ªbundleï¼š

// 1. æœåŠ¡ç«¯bundle (server.js)
module.exports = {
  getServerSideProps: async function() {
    const fs = require('fs')
    // ... å®Œæ•´ä»£ç 
  },
  default: function Page({ data }) {
    return React.createElement('div', null, data)
  }
}

// 2. å®¢æˆ·ç«¯bundle (client.js)
// getServerSideProps è¢«ç§»é™¤äº†ï¼
export default function Page({ data }) {
  return React.createElement('div', null, data)
}
// â†‘ å®¢æˆ·ç«¯ä»£ç ä¸åŒ…å« getServerSideProps
//   å› ä¸ºæµè§ˆå™¨ä¸éœ€è¦è¿™ä¸ªå‡½æ•°
```

### 2. æ•°æ®åºåˆ—åŒ–ä¸ååºåˆ—åŒ–

```javascript
// æœåŠ¡ç«¯
const props = {
  user: { name: 'Alice', age: 25 },
  date: new Date('2024-01-01')
}

// Next.js è‡ªåŠ¨åºåˆ—åŒ–ï¼ˆè½¬ä¸ºJSONï¼‰
const serialized = JSON.stringify(props)
// {"user":{"name":"Alice","age":25},"date":"2024-01-01T00:00:00.000Z"}

// æ’å…¥HTML
const html = `
  <script>
    window.__NEXT_DATA__ = ${serialized}
  </script>
`

// å®¢æˆ·ç«¯è‡ªåŠ¨ååºåˆ—åŒ–
const props = JSON.parse(window.__NEXT_DATA__)
// æ³¨æ„ï¼šDateå¯¹è±¡å˜æˆäº†å­—ç¬¦ä¸²ï¼
// props.date æ˜¯ stringï¼Œä¸æ˜¯ Date

// è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ superjson
import superjson from 'superjson'

// åºåˆ—åŒ–ï¼ˆä¿ç•™ç±»å‹ï¼‰
const serialized = superjson.stringify(props)
// {"json":{...},"meta":{"values":{"date":["Date"]}}}

// ååºåˆ—åŒ–ï¼ˆæ¢å¤ç±»å‹ï¼‰
const props = superjson.parse(serialized)
// props.date æ˜¯ Date å¯¹è±¡ âœ…
```

---

## ä¸ƒã€æ€§èƒ½ä¼˜åŒ–åŸç†

### 1. é¢„å–ï¼ˆPrefetchingï¼‰

```javascript
// Next.js è‡ªåŠ¨é¢„å–å¯è§é“¾æ¥

// pages/index.js
export default function Home() {
  return (
    <div>
      <Link href="/about">å…³äºæˆ‘ä»¬</Link>
      <Link href="/contact">è”ç³»æˆ‘ä»¬</Link>
    </div>
  )
}

// ========== Next.js è‡ªåŠ¨åšçš„äº‹ ==========

// 1. æ£€æµ‹è§†å£ä¸­çš„ Link ç»„ä»¶
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      // 2. é“¾æ¥è¿›å…¥è§†å£ï¼Œé¢„å–é¡µé¢ä»£ç 
      const href = entry.target.getAttribute('href')
      fetch(`/_next/data/about.json`)  // é¢„å–æ•°æ®
      import('./pages/about.js')       // é¢„å–ç»„ä»¶
    }
  })
})

// 3. ç”¨æˆ·ç‚¹å‡»æ—¶ï¼Œä»£ç å’Œæ•°æ®å·²ç»åŠ è½½å¥½äº†
// é¡µé¢åˆ‡æ¢å‡ ä¹ç¬é—´å®Œæˆ
```

### 2. å›¾ç‰‡ä¼˜åŒ–åŸç†

```javascript
// ä½¿ç”¨ Next.js Image ç»„ä»¶
import Image from 'next/image'

<Image 
  src="/photo.jpg"
  width={800}
  height={600}
  loading="lazy"
/>

// ========== Next.js åšçš„ä¼˜åŒ– ==========

// 1. æ ¼å¼è½¬æ¢
// åŸå§‹: /photo.jpg (2MB, JPEG)
// ä¼˜åŒ–: /_next/image?url=/photo.jpg&w=800&q=75
// è¿”å›: WebPæ ¼å¼ (500KB) æˆ– AVIFæ ¼å¼ (300KB)

// 2. å“åº”å¼å›¾ç‰‡
<img
  srcset="
    /_next/image?url=/photo.jpg&w=640 640w,
    /_next/image?url=/photo.jpg&w=750 750w,
    /_next/image?url=/photo.jpg&w=828 828w,
    /_next/image?url=/photo.jpg&w=1080 1080w
  "
  sizes="(max-width: 640px) 100vw, 50vw"
/>
// ç§»åŠ¨è®¾å¤‡åŠ è½½å°å›¾ï¼Œæ¡Œé¢è®¾å¤‡åŠ è½½å¤§å›¾

// 3. æ‡’åŠ è½½
const observer = new IntersectionObserver(...)
// å›¾ç‰‡æ¥è¿‘è§†å£æ—¶æ‰å¼€å§‹åŠ è½½

// 4. å ä½ç¬¦ï¼ˆé˜²æ­¢å¸ƒå±€åç§»ï¼‰
// æ˜¾ç¤ºæ¨¡ç³Šå›¾æˆ–çº¯è‰²ï¼ŒåŠ è½½å®Œæˆåæ·¡å…¥
```

---

## å…«ã€æ€»ç»“ï¼šNext.js/Nuxt.js ä¸åªæ˜¯"å°è£…"

### å®ƒä»¬æä¾›çš„æ˜¯å®Œæ•´çš„åº”ç”¨æ¶æ„

```
ç»„ä»¶åº“ï¼ˆå¦‚ Ant Designï¼‰:
  æä¾›: UIç»„ä»¶
  ä½ éœ€è¦è‡ªå·±: è·¯ç”±ã€SSRã€æ„å»ºã€éƒ¨ç½²
  
å·¥å…·åº“ï¼ˆå¦‚ Lodashï¼‰:
  æä¾›: å·¥å…·å‡½æ•°
  ä½ éœ€è¦è‡ªå·±: å…¨éƒ¨åº”ç”¨é€»è¾‘
  
å…ƒæ¡†æ¶ï¼ˆNext.js/Nuxt.jsï¼‰:
  æä¾›: å®Œæ•´è§£å†³æ–¹æ¡ˆ
    - è·¯ç”±ç³»ç»Ÿ âœ…
    - SSR/SSGå¼•æ“ âœ…
    - æ•°æ®è·å– âœ…
    - æ„å»ºä¼˜åŒ– âœ…
    - å¼€å‘æœåŠ¡å™¨ âœ…
    - ç”Ÿäº§éƒ¨ç½² âœ…
  ä½ åªéœ€: å†™ä¸šåŠ¡ç»„ä»¶
```

### æ ¸å¿ƒä»·å€¼

1. **æŠ½è±¡å¤æ‚åº¦**
   - ä½ ä¸éœ€è¦é…ç½® Webpack
   - ä½ ä¸éœ€è¦æ­å»º SSR æœåŠ¡å™¨
   - ä½ ä¸éœ€è¦æ‰‹åŠ¨ä»£ç åˆ†å‰²

2. **æœ€ä½³å®è·µå†…ç½®**
   - è‡ªåŠ¨ä»£ç åˆ†å‰²
   - è‡ªåŠ¨å›¾ç‰‡ä¼˜åŒ–
   - è‡ªåŠ¨é¢„å–é“¾æ¥

3. **å¼€å‘ä½“éªŒ**
   - é›¶é…ç½®å¯åŠ¨
   - çƒ­æ›´æ–°
   - TypeScript æ”¯æŒ

4. **ç”Ÿäº§å°±ç»ª**
   - è‡ªåŠ¨ä¼˜åŒ–æ„å»º
   - Edge Runtime æ”¯æŒ
   - å¢é‡é™æ€å†ç”Ÿ

**æœ€ç»ˆå®šä¹‰**ï¼š
```
Next.js = Reactæ¸²æŸ“å¼•æ“ + å®Œæ•´åº”ç”¨æ¡†æ¶
Nuxt.js = Vueæ¸²æŸ“å¼•æ“ + å®Œæ•´åº”ç”¨æ¡†æ¶

å®ƒä»¬ä¸æ˜¯ç®€å•çš„"å°è£…"æˆ–"ç»„ä»¶åº“"ï¼Œè€Œæ˜¯æ„å»ºç°ä»£Webåº”ç”¨çš„å®Œæ•´è§£å†³æ–¹æ¡ˆ
```







ç¬¬ä¸€ä¼˜å…ˆçº§ï¼šæ ¸å¿ƒå¿…è¯»ï¼ˆè§£å†³ä½ é¡¹ç›®80%çš„é—®é¢˜ï¼‰
#	ä¹¦å	ä½œè€…	è§£å†³çš„é—®é¢˜	å»ºè®®é˜…è¯»æ—¶é—´
1	ã€ŠNode.js è®¾è®¡æ¨¡å¼ã€‹	Mario Casciaro	Clusterã€Worker Threadsã€å¼‚æ­¥æ¨¡å¼ã€æ¶ˆæ¯é˜Ÿåˆ—ã€å¯æ‰©å±•æ¶æ„	2-3å‘¨
2	ã€Šé«˜æ€§èƒ½ MySQLã€‹(ç¬¬4ç‰ˆ)	Schwartz ç­‰	è¿æ¥æ± ã€ç´¢å¼•ä¼˜åŒ–ã€æŸ¥è¯¢è°ƒä¼˜ã€ä¸»ä»å¤åˆ¶	3-4å‘¨
3	ã€ŠRedis å®æˆ˜ã€‹	Josiah Carlson	ç¼“å­˜ç­–ç•¥ã€åˆ†å¸ƒå¼é”ã€é™æµã€æ¶ˆæ¯é˜Ÿåˆ—	2å‘¨
4	ã€Šç³»ç»Ÿè®¾è®¡é¢è¯•ã€‹	Alex Xu	é«˜å¹¶å‘æ¶æ„ã€è´Ÿè½½å‡è¡¡ã€CDNã€åˆ†å¸ƒå¼ç³»ç»Ÿæ€ç»´	2å‘¨
è¯»å®Œè¿™4æœ¬ â†’ ä½ èƒ½ç‹¬ç«‹è®¾è®¡å’Œä¼˜åŒ–ä¸€ä¸ªé«˜å¹¶å‘åç«¯ç³»ç»Ÿ
ğŸŸ¡ ç¬¬äºŒä¼˜å…ˆçº§ï¼šéƒ¨ç½²ä¸è¿ç»´ï¼ˆè®©ç³»ç»Ÿç¨³å®šè¿è¡Œï¼‰
#	ä¹¦å	ä½œè€…	è§£å†³çš„é—®é¢˜	å»ºè®®é˜…è¯»æ—¶é—´
5	ã€ŠDocker å®æˆ˜ã€‹(ç¬¬2ç‰ˆ)	Jeff Nickoloff	å®¹å™¨åŒ–ã€Docker Composeã€é•œåƒä¼˜åŒ–ã€ç½‘ç»œé…ç½®	2å‘¨
6	ã€ŠNginx å®æˆ˜ã€‹	é™¶è¾‰	åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡ã€é™æµã€SSLã€æ€§èƒ½è°ƒä¼˜	1-2å‘¨
7	ã€ŠSREï¼šGoogleè¿ç»´è§£å¯†ã€‹	Google SRE å›¢é˜Ÿ	ç›‘æ§ã€å‘Šè­¦ã€å¯é æ€§ã€å®¹é‡è§„åˆ’ã€äº‹æ•…å“åº”	3å‘¨
8	ã€ŠPrometheus ç›‘æ§å®æˆ˜ã€‹	James Turnbull	Metricsã€Grafanaã€å‘Šè­¦è§„åˆ™ã€ä»ªè¡¨ç›˜	1-2å‘¨
è¯»å®Œè¿™4æœ¬ â†’ ä½ èƒ½æ­å»ºå®Œæ•´çš„ç”Ÿäº§çº§éƒ¨ç½²å’Œç›‘æ§ä½“ç³»
ğŸŸ¢ ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼šä»£ç è´¨é‡ä¸å®‰å…¨ï¼ˆè®©ç³»ç»Ÿå¯ç»´æŠ¤ã€å®‰å…¨ï¼‰
#	ä¹¦å	ä½œè€…	è§£å†³çš„é—®é¢˜	å»ºè®®é˜…è¯»æ—¶é—´
9	ã€ŠEffective TypeScriptã€‹	Dan Vanderkam	ç±»å‹å®‰å…¨ã€é”™è¯¯å¤„ç†ã€ä»£ç è´¨é‡	1-2å‘¨
10	ã€Šå•å…ƒæµ‹è¯•çš„è‰ºæœ¯ã€‹(ç¬¬3ç‰ˆ)	Roy Osherove	æµ‹è¯•ç­–ç•¥ã€Mockã€TDDã€é›†æˆæµ‹è¯•	2å‘¨
11	ã€ŠWeb åº”ç”¨å®‰å…¨ã€‹	Andrew Hoffman	JWTå®‰å…¨ã€XSSã€CSRFã€SQLæ³¨å…¥ã€APIå®‰å…¨	2å‘¨
12	ã€Šä»£ç æ•´æ´ä¹‹é“ã€‹	Robert Martin	ä»£ç è§„èŒƒã€é‡æ„ã€å¯



åç«¯å‹æµ‹ä¸éªŒè¯æŒ‡å—
ä¸€ã€å¸¸ç”¨å‹æµ‹å·¥å…·
å·¥å…·	ç‰¹ç‚¹	æ¨èåœºæ™¯	å®‰è£…
autocannon	Node.js åŸç”Ÿã€ç®€å•æ˜“ç”¨	â­ æ—¥å¸¸å¿«é€Ÿæµ‹è¯•	npm i -g autocannon
wrk	C ç¼–å†™ã€æ€§èƒ½æé«˜	â­ ä¸“ä¸šå‹æµ‹	brew install wrk
k6	å¯ç¼–å†™è„šæœ¬ã€æ”¯æŒå¤æ‚åœºæ™¯	â­ çœŸå®ä¸šåŠ¡æ¨¡æ‹Ÿ	brew install k6
Apache JMeter	GUIã€åŠŸèƒ½å…¨é¢	å¤æ‚æµ‹è¯•è®¡åˆ’	å®˜ç½‘ä¸‹è½½
Artillery	YAML é…ç½®ã€æ”¯æŒ WebSocket	WebSocket æµ‹è¯•	npm i -g artillery
æˆ‘æ¨èï¼šæ—¥å¸¸ç”¨ autocannonï¼Œæ·±å…¥ç”¨ k6
äºŒã€å…³é”®æ€§èƒ½æŒ‡æ ‡
æŒ‡æ ‡	å«ä¹‰	å¥åº·å€¼	è­¦å‘Šå€¼
QPS/RPS	æ¯ç§’è¯·æ±‚æ•°	è¶Šé«˜è¶Šå¥½	-
Latency P50	50%è¯·æ±‚çš„å»¶è¿Ÿ	< 100ms	> 200ms
Latency P99	99%è¯·æ±‚çš„å»¶è¿Ÿ	< 500ms	> 1s
Error Rate	é”™è¯¯ç‡	< 0.1%	> 1%
Throughput	ååé‡(MB/s)	ç¨³å®š	å‰§çƒˆæ³¢åŠ¨

å‹æµ‹æ—¶è¦åŒæ—¶ç›‘æ§æœåŠ¡å™¨èµ„æºï¼š
# ç»ˆç«¯ 1: è¿è¡Œå‹æµ‹
autocannon -c 100 -d 60 http://localhost:3000/health
# ç»ˆç«¯ 2: ç›‘æ§ Docker å®¹å™¨èµ„æº
docker stats paaawow-backend paaawow-mysql paaawow-redis
# è¾“å‡ºï¼š
# CONTAINER         CPU %   MEM USAGE / LIMIT     MEM %
# paaawow-backend   85%     256MiB / 512MiB       50%
# paaawow-mysql     45%     512MiB / 1GiB         50%
# paaawow-redis     5%      32MiB / 256MiB        12%

éªŒè¯æ¸…å•
æ¯æ¬¡ä¼˜åŒ–åï¼Œæ£€æŸ¥è¿™äº›ï¼š
æ£€æŸ¥é¡¹	æ–¹æ³•	æœŸæœ›
âœ… QPS æ˜¯å¦æå‡	å‹æµ‹å¯¹æ¯”	æå‡ > 20%
âœ… P99 å»¶è¿Ÿæ˜¯å¦é™ä½	å‹æµ‹å¯¹æ¯”	é™ä½ > 20%
âœ… é”™è¯¯ç‡æ˜¯å¦ä¸º 0	å‹æµ‹ç»“æœ	= 0%
âœ… CPU ä½¿ç”¨æ˜¯å¦åˆç†	docker stats	< 80%
âœ… å†…å­˜æ˜¯å¦ç¨³å®š	docker stats	æ— æŒç»­å¢é•¿
âœ… åŠŸèƒ½æ˜¯å¦æ­£å¸¸	æ‰‹åŠ¨æµ‹è¯•	æ‰€æœ‰åŠŸèƒ½æ­£å¸¸







